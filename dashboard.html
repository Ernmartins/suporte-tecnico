<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Dashboard â€“ SmartHelp</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body>
<div class="container">
  <h1>ðŸ“Š Dashboard</h1>
  <canvas id="grafico1"></canvas>
</div>

<script type="module">
  import { firebaseConfig } from "./firebase.js";
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const snap = await getDocs(collection(db, "tickets"));

  let abertos = 0, andamento = 0, resolvidos = 0;

  snap.forEach(doc => {
    const estado = doc.data().estado;
    if (estado === "Aberto") abertos++;
    if (estado === "Em andamento") andamento++;
    if (estado === "Resolvido") resolvidos++;
  });

  new Chart(document.getElementById("grafico1"), {
    type: "pie",
    data: {
      labels: ["Abertos", "Em andamento", "Resolvidos"],
      datasets: [{
        data: [abertos, andamento, resolvidos],
        backgroundColor: ["#f87171", "#facc15", "#4ade80"]
      }]
    }
  });
</script>
</body>
</html>
